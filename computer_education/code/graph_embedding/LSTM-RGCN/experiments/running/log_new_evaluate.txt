configs: {'log_file': 'log_new_evaluate', 'name': 'OJ_FB_mini', 'save_dir': 'running'} {'epochs': 50, 'graph_batch_size': 1024, 'negative_sampling': {'head_prob': 0.5, 'sampling_rate': 10}, 'optimiser': {'algorithm': 'adam', 'learn_rate': 0.001, 'weight_decay': 0.0001}, 'sampling_method': 'edge-neighborhood', 'use_cuda': True, 'use_time': True, 'use_weight': False} {'activation': 'lrelu', 'bias_init': 'zeros', 'edge_dropout': {'general': 0.3, 'self_loop': 0.2, 'self_loop_type': 'schlichtkrull-dropout'}, 'hidden1_size': 200, 'hidden2_size': 200, 'include_gain': False, 'lstm_weight_init': 'xavier-normal', 'model': 'rgcn', 'node_embedding': 200, 'num_layers': 2, 'rgcn_weight_init': 'schlichtkrull-normal'} {'include_gain': False, 'l2_penalty': 1, 'l2_penalty_type': 'schlichtkrull-l2', 'loss_expand': 100, 'model': 'distmult', 'weight_init': 'standard-normal'} {'batch_size': 512, 'check_every': 5, 'filtered': True, 'use_valid': False, 'verbose': True}
num_nodes = 588 num_relations = 9
[Epoch 1] Loss: 127.0855408 Forward: 0.929s Backward: 0.715s 
[Epoch 2] Loss: 127.0456543 Forward: 0.888s Backward: 0.602s 
[Epoch 3] Loss: 127.0166702 Forward: 0.997s Backward: 0.592s 
[Epoch 4] Loss: 126.9719391 Forward: 1.111s Backward: 0.582s 
[Epoch 5] Loss: 126.9600906 Forward: 1.008s Backward: 0.513s 
embeddings: tensor([[ 2.2324e-03, -7.2238e-05,  3.5062e-03,  ..., -1.4627e-05,
          1.0130e-02, -5.2644e-05],
        [ 9.5066e-03, -1.8705e-05,  2.1388e-03,  ..., -1.5530e-04,
          8.3271e-03, -2.3530e-05],
        [-1.3049e-04, -2.6201e-05, -5.1747e-05,  ..., -1.6076e-04,
         -7.3181e-05, -9.7217e-06],
        ...,
        [ 1.1962e-02, -2.0562e-04, -5.5317e-07,  ..., -1.0695e-04,
          1.5581e-02, -2.5339e-04],
        [ 1.9946e-02,  5.4478e-04, -3.1351e-04,  ...,  3.3556e-02,
          6.5282e-03,  2.1170e-02],
        [ 1.1150e-02,  2.6406e-03,  3.4737e-03,  ..., -8.8867e-05,
          1.6434e-02, -1.3325e-04]])
[Epoch 5]
==================== Evaluation ====================
F1: 0.13 	
MAP: 0.1296 	
MRR: 0.1597 	
MNDCG: 0.2191 	
[Epoch 6] Loss: 126.9200287 Forward: 0.888s Backward: 0.501s 
[Epoch 7] Loss: 126.8891525 Forward: 0.978s Backward: 0.520s 
[Epoch 8] Loss: 126.8620071 Forward: 1.017s Backward: 0.503s 
[Epoch 9] Loss: 126.8143158 Forward: 0.879s Backward: 0.495s 
[Epoch 10] Loss: 126.8018723 Forward: 1.087s Backward: 0.542s 
embeddings: tensor([[ 7.9681e-03, -1.0638e-04,  7.2803e-04,  ..., -2.5318e-06,
          1.3885e-02, -2.7149e-05],
        [ 2.0396e-02, -8.3055e-05,  8.3496e-05,  ..., -1.5687e-04,
          1.2863e-02,  4.4620e-03],
        [-2.9569e-05, -7.6615e-05, -9.1196e-05,  ..., -1.2275e-04,
         -2.2390e-05,  2.2232e-03],
        ...,
        [ 2.1172e-02, -2.6749e-04, -2.1107e-05,  ..., -1.1170e-04,
          2.0197e-02, -1.9912e-04],
        [ 2.9931e-02, -3.3962e-05, -3.5091e-04,  ...,  3.7284e-02,
          9.2119e-03,  2.5703e-02],
        [ 2.0904e-02, -2.8481e-05,  9.6817e-04,  ..., -9.5141e-05,
          2.0219e-02, -7.3787e-05]])
[Epoch 10]
==================== Evaluation ====================
F1: 0.1331 	
MAP: 0.1206 	
MRR: 0.1513 	
MNDCG: 0.2139 	
[Epoch 11] Loss: 126.7782745 Forward: 0.945s Backward: 0.516s 
[Epoch 12] Loss: 126.7169495 Forward: 1.089s Backward: 0.574s 
[Epoch 13] Loss: 126.6757736 Forward: 1.028s Backward: 0.519s 
[Epoch 14] Loss: 126.6151428 Forward: 1.064s Backward: 0.525s 
[Epoch 15] Loss: 126.6618881 Forward: 1.163s Backward: 0.612s 
embeddings: tensor([[ 1.4203e-02, -8.8067e-05,  2.1742e-03,  ...,  4.2042e-03,
          1.8497e-02, -2.4820e-06],
        [ 3.1910e-02, -7.4634e-05,  2.7885e-03,  ..., -1.1068e-04,
          1.8695e-02,  1.1595e-02],
        [ 7.9174e-03, -5.2111e-05, -7.6317e-05,  ..., -4.3867e-05,
          4.3968e-03,  7.0602e-03],
        ...,
        [ 3.0960e-02, -2.6431e-04,  3.6009e-04,  ..., -7.2369e-05,
          2.6057e-02, -1.4364e-04],
        [ 4.0762e-02, -6.2898e-06, -3.3797e-04,  ...,  4.5218e-02,
          1.3231e-02,  3.1443e-02],
        [ 3.1454e-02, -1.5659e-05,  3.1692e-03,  ..., -5.8774e-05,
          2.4996e-02, -1.2657e-05]])
[Epoch 15]
==================== Evaluation ====================
F1: 0.1242 	
MAP: 0.1176 	
MRR: 0.1468 	
MNDCG: 0.2039 	
[Epoch 16] Loss: 126.5743484 Forward: 0.985s Backward: 0.662s 
[Epoch 17] Loss: 126.4619370 Forward: 0.930s Backward: 0.554s 
[Epoch 18] Loss: 126.4185562 Forward: 0.941s Backward: 0.583s 
[Epoch 19] Loss: 126.4113388 Forward: 0.908s Backward: 0.520s 
[Epoch 20] Loss: 126.2308121 Forward: 0.817s Backward: 0.553s 
embeddings: tensor([[ 2.0706e-02, -4.8808e-05,  4.7702e-03,  ...,  9.7459e-03,
          2.3519e-02,  4.2081e-03],
        [ 4.3899e-02, -4.0419e-05,  7.2272e-03,  ..., -5.9477e-05,
          2.4186e-02,  2.1451e-02],
        [ 1.9254e-02,  4.6291e-04, -4.6035e-05,  ...,  5.2425e-03,
          1.0684e-02,  1.5192e-02],
        ...,
        [ 4.1157e-02, -2.3677e-04,  4.5516e-03,  ..., -2.7437e-05,
          3.1760e-02, -6.2986e-05],
        [ 5.2087e-02,  5.0462e-03, -3.0954e-04,  ...,  5.4857e-02,
          1.7116e-02,  4.0001e-02],
        [ 4.2605e-02,  2.1730e-03,  6.8825e-03,  ..., -1.8775e-05,
          2.9924e-02,  7.6797e-03]])
[Epoch 20]
==================== Evaluation ====================
F1: 0.1234 	
MAP: 0.116 	
MRR: 0.1449 	
MNDCG: 0.2012 	
[Epoch 21] Loss: 126.2574844 Forward: 0.864s Backward: 0.575s 
[Epoch 22] Loss: 126.1778412 Forward: 1.012s Backward: 0.591s 
[Epoch 23] Loss: 125.9314804 Forward: 0.995s Backward: 0.575s 
[Epoch 24] Loss: 125.8743896 Forward: 0.942s Backward: 0.498s 
[Epoch 25] Loss: 125.6994858 Forward: 1.014s Backward: 0.554s 
embeddings: tensor([[ 2.7535e-02,  1.5419e-04,  9.1440e-03,  ...,  1.6131e-02,
          2.9155e-02,  1.0123e-02],
        [ 5.6660e-02,  3.0897e-05,  1.4075e-02,  ..., -6.5167e-06,
          3.0652e-02,  3.3335e-02],
        [ 3.1098e-02,  7.7624e-03,  4.1151e-05,  ...,  1.6345e-02,
          1.8293e-02,  2.5650e-02],
        ...,
        [ 5.1992e-02, -2.0263e-04,  1.0919e-02,  ...,  1.8260e-03,
          3.8460e-02,  3.6849e-03],
        [ 6.3861e-02,  1.2147e-02, -2.6573e-04,  ...,  6.5658e-02,
          2.2824e-02,  5.0380e-02],
        [ 5.4456e-02,  6.8436e-03,  1.2694e-02,  ...,  2.2738e-03,
          3.5292e-02,  1.8594e-02]])
[Epoch 25]
==================== Evaluation ====================
F1: 0.1261 	
MAP: 0.1146 	
MRR: 0.1418 	
MNDCG: 0.2025 	
[Epoch 26] Loss: 125.8630676 Forward: 0.839s Backward: 0.559s 
[Epoch 27] Loss: 125.7088318 Forward: 1.010s Backward: 0.532s 
[Epoch 28] Loss: 125.5283890 Forward: 1.057s Backward: 0.826s 
[Epoch 29] Loss: 125.4805527 Forward: 0.867s Backward: 0.851s 
[Epoch 30] Loss: 125.4029160 Forward: 1.070s Backward: 0.780s 
embeddings: tensor([[ 0.0345,  0.0065,  0.0151,  ...,  0.0232,  0.0352,  0.0172],
        [ 0.0698,  0.0047,  0.0230,  ...,  0.0047,  0.0376,  0.0469],
        [ 0.0432,  0.0171,  0.0053,  ...,  0.0286,  0.0271,  0.0378],
        ...,
        [ 0.0631, -0.0002,  0.0193,  ...,  0.0065,  0.0456,  0.0152],
        [ 0.0760,  0.0209, -0.0002,  ...,  0.0777,  0.0293,  0.0626],
        [ 0.0667,  0.0124,  0.0205,  ...,  0.0062,  0.0412,  0.0312]])
[Epoch 30]
==================== Evaluation ====================
F1: 0.1277 	
MAP: 0.1162 	
MRR: 0.1434 	
MNDCG: 0.206 	
[Epoch 31] Loss: 124.9685669 Forward: 0.895s Backward: 0.511s 
[Epoch 32] Loss: 124.8934784 Forward: 0.998s Backward: 0.604s 
[Epoch 33] Loss: 125.0382156 Forward: 1.226s Backward: 0.562s 
[Epoch 34] Loss: 124.5263519 Forward: 1.009s Backward: 0.527s 
[Epoch 35] Loss: 124.2817764 Forward: 0.974s Backward: 0.517s 
embeddings: tensor([[ 0.0416,  0.0136,  0.0219,  ...,  0.0301,  0.0421,  0.0250],
        [ 0.0834,  0.0096,  0.0341,  ...,  0.0090,  0.0465,  0.0617],
        [ 0.0558,  0.0283,  0.0099,  ...,  0.0412,  0.0375,  0.0513],
        ...,
        [ 0.0746, -0.0001,  0.0295,  ...,  0.0106,  0.0543,  0.0277],
        [ 0.0884,  0.0312, -0.0002,  ...,  0.0901,  0.0373,  0.0761],
        [ 0.0793,  0.0179,  0.0304,  ...,  0.0093,  0.0484,  0.0449]])
[Epoch 35]
==================== Evaluation ====================
F1: 0.1236 	
MAP: 0.1164 	
MRR: 0.1427 	
MNDCG: 0.2025 	
[Epoch 36] Loss: 124.5441742 Forward: 0.927s Backward: 0.556s 
[Epoch 37] Loss: 124.5931396 Forward: 1.053s Backward: 0.633s 
[Epoch 38] Loss: 123.6244583 Forward: 1.078s Backward: 0.529s 
[Epoch 39] Loss: 123.7093506 Forward: 0.968s Backward: 0.695s 
[Epoch 40] Loss: 124.2534256 Forward: 1.023s Backward: 0.711s 
embeddings: tensor([[ 4.8564e-02,  2.1353e-02,  2.9382e-02,  ...,  3.6417e-02,
          4.9357e-02,  3.2832e-02],
        [ 9.7105e-02,  1.4575e-02,  4.6604e-02,  ...,  1.1421e-02,
          5.6751e-02,  7.6831e-02],
        [ 6.8253e-02,  4.1008e-02,  1.4174e-02,  ...,  5.3156e-02,
          4.8505e-02,  6.5093e-02],
        ...,
        [ 8.6119e-02, -7.1828e-05,  4.1132e-02,  ...,  1.3474e-02,
          6.4064e-02,  4.0480e-02],
        [ 1.0072e-01,  4.2642e-02, -1.3817e-04,  ...,  1.0202e-01,
          4.5784e-02,  8.9810e-02],
        [ 9.2146e-02,  2.3361e-02,  4.1922e-02,  ...,  1.0893e-02,
          5.6205e-02,  5.9044e-02]])
[Epoch 40]
==================== Evaluation ====================
F1: 0.1149 	
MAP: 0.1129 	
MRR: 0.1377 	
MNDCG: 0.1918 	
[Epoch 41] Loss: 123.3990402 Forward: 0.804s Backward: 0.614s 
[Epoch 42] Loss: 124.0047913 Forward: 1.002s Backward: 0.572s 
[Epoch 43] Loss: 122.7660522 Forward: 0.894s Backward: 0.520s 
[Epoch 44] Loss: 123.6931381 Forward: 1.004s Backward: 0.588s 
[Epoch 45] Loss: 123.6957779 Forward: 0.937s Backward: 0.995s 
embeddings: tensor([[ 5.4372e-02,  2.9192e-02,  3.7333e-02,  ...,  4.3518e-02,
          5.7264e-02,  3.9747e-02],
        [ 1.0955e-01,  1.9125e-02,  6.0384e-02,  ...,  1.4867e-02,
          6.8028e-02,  9.1067e-02],
        [ 7.9498e-02,  5.4384e-02,  1.8708e-02,  ...,  6.6238e-02,
          6.0746e-02,  7.7886e-02],
        ...,
        [ 9.6399e-02, -2.8869e-05,  5.3673e-02,  ...,  1.7219e-02,
          7.4774e-02,  5.2382e-02],
        [ 1.1188e-01,  5.4635e-02, -1.0253e-04,  ...,  1.1514e-01,
          5.5593e-02,  1.0281e-01],
        [ 1.0381e-01,  2.8525e-02,  5.4791e-02,  ...,  1.3371e-02,
          6.4767e-02,  7.2315e-02]])
[Epoch 45]
==================== Evaluation ====================
F1: 0.1084 	
MAP: 0.1106 	
MRR: 0.1336 	
MNDCG: 0.1845 	
[Epoch 46] Loss: 123.4985504 Forward: 0.915s Backward: 0.849s 
[Epoch 47] Loss: 123.1074142 Forward: 1.015s Backward: 0.785s 
[Epoch 48] Loss: 122.2191696 Forward: 0.942s Backward: 0.783s 
[Epoch 49] Loss: 123.2586899 Forward: 1.011s Backward: 0.703s 
[Epoch 50] Loss: 121.5398788 Forward: 0.986s Backward: 0.483s 
embeddings: tensor([[ 5.8265e-02,  3.6644e-02,  4.5716e-02,  ...,  5.1140e-02,
          6.5684e-02,  4.4564e-02],
        [ 1.1986e-01,  2.2772e-02,  7.4989e-02,  ...,  1.8880e-02,
          7.9597e-02,  1.0323e-01],
        [ 8.8465e-02,  6.7808e-02,  2.3318e-02,  ...,  8.0076e-02,
          7.3894e-02,  8.8275e-02],
        ...,
        [ 1.0466e-01,  6.3488e-04,  6.6832e-02,  ...,  2.1323e-02,
          8.5546e-02,  6.2259e-02],
        [ 1.2114e-01,  6.6525e-02, -7.0304e-05,  ...,  1.2901e-01,
          6.6310e-02,  1.1375e-01],
        [ 1.1351e-01,  3.2377e-02,  6.8538e-02,  ...,  1.6167e-02,
          7.3708e-02,  8.3558e-02]])
[Epoch 50]
==================== Evaluation ====================
F1: 0.1084 	
MAP: 0.1081 	
MRR: 0.1313 	
MNDCG: 0.1824 	
Training is complete!
Starting final evaluation...
==================== Final Evaluation ====================
[Final Scores] Total Epoch 50 	 Best Epoch 5
F1: 0.13 	
MAP: 0.1296 	
MRR: 0.1597 	
MNDCG: 0.2191 	
