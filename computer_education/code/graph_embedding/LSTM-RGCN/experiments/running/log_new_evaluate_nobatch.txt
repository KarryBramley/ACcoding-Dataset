configs: {'log_file': 'log_new_evaluate_nobatch', 'name': 'OJ_FB_mini', 'save_dir': 'running'} {'epochs': 50, 'graph_batch_size': 1024, 'negative_sampling': {'head_prob': 0.5, 'sampling_rate': 10}, 'optimiser': {'algorithm': 'adam', 'learn_rate': 0.001, 'weight_decay': 0.0001}, 'sampling_method': 'edge-neighborhood', 'use_cuda': True, 'use_time': True, 'use_weight': False} {'activation': 'lrelu', 'bias_init': 'zeros', 'edge_dropout': {'general': 0.3, 'self_loop': 0.2, 'self_loop_type': 'schlichtkrull-dropout'}, 'hidden1_size': 200, 'hidden2_size': 200, 'include_gain': False, 'lstm_weight_init': 'xavier-normal', 'model': 'rgcn', 'node_embedding': 200, 'num_layers': 2, 'rgcn_weight_init': 'schlichtkrull-normal'} {'include_gain': False, 'l2_penalty': 1, 'l2_penalty_type': 'schlichtkrull-l2', 'loss_expand': 100, 'model': 'distmult', 'weight_init': 'standard-normal'} {'batch_size': 512, 'check_every': 5, 'filtered': True, 'use_valid': False, 'verbose': True}
num_nodes = 588 num_relations = 9
[Epoch 1] Loss: 127.0587158 Forward: 0.852s Backward: 0.778s 
[Epoch 2] Loss: 127.0331802 Forward: 0.903s Backward: 0.577s 
[Epoch 3] Loss: 127.0182037 Forward: 1.017s Backward: 0.570s 
[Epoch 4] Loss: 126.9821854 Forward: 1.110s Backward: 0.502s 
[Epoch 5] Loss: 126.9677505 Forward: 0.946s Backward: 0.652s 
embeddings: tensor([[-1.2080e-04, -1.8963e-04,  2.2468e-03,  ..., -1.1510e-04,
         -1.0866e-04, -8.2127e-05],
        [-5.5727e-05,  2.5888e-02,  2.1971e-02,  ..., -6.6806e-05,
         -1.9745e-04, -7.5588e-06],
        [-2.0581e-04, -1.1567e-06, -2.0682e-04,  ..., -1.1246e-04,
          1.7375e-02, -1.1192e-04],
        ...,
        [-5.2437e-04,  1.0619e-03,  1.4232e-02,  ...,  2.4917e-02,
         -4.8621e-04, -9.5113e-05],
        [-5.2068e-05,  1.1426e-02, -2.0547e-04,  ...,  6.0601e-03,
         -3.7261e-04,  8.4985e-03],
        [-2.2094e-04, -5.1417e-05, -5.2535e-05,  ...,  3.2937e-02,
         -1.4044e-04,  1.1611e-04]])
[Epoch 5]
==================== Evaluation ====================
F1: 0.0416 	
MAP: 0.0344 	
MRR: 0.0467 	
MNDCG: 0.068 	
[Epoch 6] Loss: 126.9470215 Forward: 0.880s Backward: 0.453s 
[Epoch 7] Loss: 126.9008636 Forward: 1.066s Backward: 0.495s 
[Epoch 8] Loss: 126.8756485 Forward: 1.035s Backward: 0.499s 
[Epoch 9] Loss: 126.8460999 Forward: 0.976s Backward: 0.514s 
[Epoch 10] Loss: 126.7910614 Forward: 0.900s Backward: 0.496s 
embeddings: tensor([[-1.5940e-04, -2.3054e-04,  5.7298e-04,  ..., -1.2225e-04,
         -1.4111e-04, -7.9663e-05],
        [-9.8811e-05,  2.0722e-02,  2.0195e-02,  ..., -6.9943e-05,
         -2.4477e-04, -1.4272e-05],
        [-2.4381e-04, -4.7025e-05, -2.3545e-04,  ..., -1.1885e-04,
          1.4033e-02, -1.0046e-04],
        ...,
        [-5.6723e-04, -2.4261e-05,  1.0878e-02,  ...,  2.5921e-02,
         -5.4125e-04, -8.9949e-05],
        [-1.0097e-04,  6.0851e-03, -2.3492e-04,  ...,  5.3444e-03,
         -4.0517e-04,  9.3555e-03],
        [-2.6080e-04, -9.5878e-05, -7.5951e-05,  ...,  3.2393e-02,
         -1.7786e-04,  8.0299e-04]])
[Epoch 10]
==================== Evaluation ====================
F1: 0.0404 	
MAP: 0.032 	
MRR: 0.0416 	
MNDCG: 0.0641 	
[Epoch 11] Loss: 126.7715836 Forward: 0.820s Backward: 0.471s 
[Epoch 12] Loss: 126.7220154 Forward: 1.079s Backward: 0.441s 
[Epoch 13] Loss: 126.7690048 Forward: 0.969s Backward: 0.501s 
[Epoch 14] Loss: 126.6732864 Forward: 0.896s Backward: 0.510s 
[Epoch 15] Loss: 126.5774307 Forward: 0.981s Backward: 0.439s 
embeddings: tensor([[-1.8312e-04, -2.5574e-04,  9.9829e-04,  ..., -1.0581e-04,
         -1.5133e-04, -6.3801e-05],
        [-1.2383e-04,  1.7524e-02,  2.0896e-02,  ..., -4.5118e-05,
         -2.5864e-04, -4.9000e-06],
        [-2.6555e-04, -7.6108e-05, -2.3504e-04,  ..., -1.0006e-04,
          1.3322e-02, -7.6058e-05],
        ...,
        [-5.8865e-04, -4.9698e-05,  1.0596e-02,  ...,  2.9358e-02,
         -5.6214e-04, -7.0299e-05],
        [-1.2987e-04,  2.5997e-03, -2.3174e-04,  ...,  7.6918e-03,
         -4.0596e-04,  1.1683e-02],
        [-2.8207e-04, -1.2466e-04, -7.2999e-05,  ...,  3.4257e-02,
         -1.8859e-04,  2.8435e-03]])
[Epoch 15]
==================== Evaluation ====================
F1: 0.0382 	
MAP: 0.0302 	
MRR: 0.0368 	
MNDCG: 0.0607 	
[Epoch 16] Loss: 126.6102905 Forward: 0.870s Backward: 0.522s 
[Epoch 17] Loss: 126.6490250 Forward: 1.020s Backward: 0.561s 
[Epoch 18] Loss: 126.6029968 Forward: 1.011s Backward: 0.528s 
[Epoch 19] Loss: 126.3643875 Forward: 0.976s Backward: 0.507s 
[Epoch 20] Loss: 126.2302628 Forward: 0.886s Backward: 0.486s 
embeddings: tensor([[-1.9844e-04, -2.6520e-04,  1.5785e-03,  ..., -6.7238e-05,
         -1.5715e-04, -4.1783e-05],
        [-1.4000e-04,  1.6116e-02,  2.1573e-02,  ...,  7.0052e-04,
         -2.6636e-04,  1.0774e-03],
        [-2.7902e-04, -8.6245e-05, -2.3247e-04,  ..., -5.8603e-05,
          1.2972e-02, -4.2028e-05],
        ...,
        [-5.9990e-04, -6.1375e-05,  1.0641e-02,  ...,  3.5283e-02,
         -5.7285e-04, -3.9406e-05],
        [-1.4804e-04,  1.1510e-03, -2.2520e-04,  ...,  1.2648e-02,
         -4.0278e-04,  1.4853e-02],
        [-2.9402e-04, -1.3632e-04, -6.8404e-05,  ...,  3.8470e-02,
         -1.9418e-04,  5.7725e-03]])
[Epoch 20]
==================== Evaluation ====================
F1: 0.0358 	
MAP: 0.0297 	
MRR: 0.0357 	
MNDCG: 0.0577 	
[Epoch 21] Loss: 126.4109116 Forward: 0.997s Backward: 0.669s 
[Epoch 22] Loss: 126.2807693 Forward: 0.917s Backward: 0.573s 
[Epoch 23] Loss: 126.0636749 Forward: 0.950s Backward: 0.556s 
[Epoch 24] Loss: 126.0664749 Forward: 0.938s Backward: 0.578s 
[Epoch 25] Loss: 125.6512833 Forward: 0.916s Backward: 0.503s 
embeddings: tensor([[-2.0749e-04, -2.6711e-04,  2.3002e-03,  ..., -1.0633e-05,
         -1.5615e-04,  1.7915e-04],
        [-1.4913e-04,  1.5408e-02,  2.2278e-02,  ...,  8.3374e-03,
         -2.6314e-04,  4.6486e-03],
        [-2.8598e-04, -8.6212e-05, -2.2787e-04,  ..., -1.8188e-06,
          1.3382e-02,  1.7882e-03],
        ...,
        [-6.0336e-04, -6.6213e-05,  1.0998e-02,  ...,  4.3463e-02,
         -5.7183e-04,  1.9767e-03],
        [-1.5813e-04,  7.2732e-04, -2.1627e-04,  ...,  1.9766e-02,
         -3.9180e-04,  2.0537e-02],
        [-2.9865e-04, -1.3906e-04, -6.1747e-05,  ...,  4.4734e-02,
         -1.9171e-04,  1.1315e-02]])
[Epoch 25]
==================== Evaluation ====================
F1: 0.0343 	
MAP: 0.027 	
MRR: 0.0334 	
MNDCG: 0.053 	
[Epoch 26] Loss: 125.6445618 Forward: 0.824s Backward: 0.743s 
[Epoch 27] Loss: 125.6759186 Forward: 0.977s Backward: 0.605s 
[Epoch 28] Loss: 125.5175781 Forward: 0.894s Backward: 0.591s 
[Epoch 29] Loss: 125.7515030 Forward: 1.001s Backward: 0.611s 
[Epoch 30] Loss: 125.4225616 Forward: 1.210s Backward: 0.652s 
embeddings: tensor([[-2.1477e-04, -2.6039e-04,  4.1182e-03,  ...,  6.0489e-03,
         -1.5335e-04,  6.0343e-03],
        [-1.5681e-04,  1.5705e-02,  2.4452e-02,  ...,  1.8332e-02,
         -2.5620e-04,  9.1861e-03],
        [-2.9117e-04, -7.5691e-05, -2.1078e-04,  ...,  6.9991e-03,
          1.3833e-02,  1.0463e-02],
        ...,
        [-6.0460e-04, -6.1136e-05,  1.2528e-02,  ...,  5.4329e-02,
         -5.6720e-04,  1.0533e-02],
        [-1.6612e-04,  1.4240e-03, -1.9356e-04,  ...,  2.9169e-02,
         -3.8064e-04,  2.8744e-02],
        [-3.0273e-04, -1.3130e-04, -4.3295e-05,  ...,  5.3100e-02,
         -1.8783e-04,  1.9158e-02]])
[Epoch 30]
==================== Evaluation ====================
F1: 0.0367 	
MAP: 0.028 	
MRR: 0.0349 	
MNDCG: 0.0561 	
[Epoch 31] Loss: 124.9746704 Forward: 0.890s Backward: 0.527s 
[Epoch 32] Loss: 125.1826859 Forward: 1.003s Backward: 0.590s 
[Epoch 33] Loss: 124.5870667 Forward: 0.961s Backward: 0.512s 
[Epoch 34] Loss: 124.5237808 Forward: 0.834s Backward: 0.551s 
[Epoch 35] Loss: 125.2480698 Forward: 1.055s Backward: 0.570s 
embeddings: tensor([[-2.1889e-04, -2.5127e-04,  6.5047e-03,  ...,  1.3686e-02,
         -1.4932e-04,  1.2383e-02],
        [-1.6089e-04,  1.6184e-02,  2.7583e-02,  ...,  2.9079e-02,
         -2.4719e-04,  1.2950e-02],
        [-2.9302e-04, -6.3101e-05, -1.8950e-04,  ...,  1.3341e-02,
          1.4343e-02,  2.0786e-02],
        ...,
        [-6.0182e-04, -5.5345e-05,  1.3978e-02,  ...,  6.6365e-02,
         -5.6061e-04,  2.0707e-02],
        [-1.7000e-04,  2.3847e-03, -1.6663e-04,  ...,  3.8270e-02,
         -3.6928e-04,  3.7766e-02],
        [-3.0280e-04, -1.2168e-04, -2.1677e-05,  ...,  6.1853e-02,
         -1.8281e-04,  2.8171e-02]])
[Epoch 35]
==================== Evaluation ====================
F1: 0.0429 	
MAP: 0.0313 	
MRR: 0.0377 	
MNDCG: 0.0647 	
[Epoch 36] Loss: 124.1446304 Forward: 0.868s Backward: 0.516s 
[Epoch 37] Loss: 124.0786057 Forward: 1.003s Backward: 0.586s 
[Epoch 38] Loss: 124.7772903 Forward: 1.043s Backward: 0.555s 
[Epoch 39] Loss: 124.2596817 Forward: 1.020s Backward: 0.515s 
[Epoch 40] Loss: 124.4308243 Forward: 1.000s Backward: 0.751s 
embeddings: tensor([[-2.2039e-04, -2.4167e-04,  1.1685e-02,  ...,  2.1567e-02,
         -1.3868e-04,  1.9149e-02],
        [-1.6206e-04,  1.6646e-02,  3.3887e-02,  ...,  4.0402e-02,
         -2.3023e-04,  1.6144e-02],
        [-2.9179e-04, -4.9586e-05, -1.4812e-04,  ...,  1.9140e-02,
          1.5791e-02,  3.2393e-02],
        ...,
        [-5.9481e-04, -4.8884e-05,  1.7231e-02,  ...,  7.8915e-02,
         -5.4517e-04,  3.2457e-02],
        [-1.7024e-04,  3.4216e-03, -1.1894e-04,  ...,  4.6989e-02,
         -3.4761e-04,  4.7887e-02],
        [-2.9939e-04, -1.1146e-04,  2.2111e-03,  ...,  7.0797e-02,
         -1.6964e-04,  3.8331e-02]])
[Epoch 40]
==================== Evaluation ====================
F1: 0.044 	
MAP: 0.0317 	
MRR: 0.0394 	
MNDCG: 0.0662 	
[Epoch 41] Loss: 124.2210999 Forward: 0.837s Backward: 0.639s 
[Epoch 42] Loss: 124.2634811 Forward: 1.011s Backward: 0.663s 
[Epoch 43] Loss: 124.0470200 Forward: 1.039s Backward: 0.645s 
[Epoch 44] Loss: 123.2898178 Forward: 1.026s Backward: 0.606s 
[Epoch 45] Loss: 122.8707428 Forward: 0.985s Backward: 0.577s 
embeddings: tensor([[-2.3065e-04, -2.2873e-04,  1.8292e-02,  ...,  2.9410e-02,
         -1.2219e-04,  2.6285e-02],
        [-1.7199e-04,  1.7429e-02,  4.2204e-02,  ...,  5.1764e-02,
         -2.0517e-04,  1.8813e-02],
        [-2.9967e-04, -2.8479e-05, -1.1218e-04,  ...,  2.4370e-02,
          1.8168e-02,  4.4903e-02],
        ...,
        [-5.9736e-04, -3.4114e-05,  2.0895e-02,  ...,  9.1154e-02,
         -5.2397e-04,  4.5665e-02],
        [-1.8099e-04,  5.1232e-03, -6.9190e-05,  ...,  5.4997e-02,
         -3.1612e-04,  5.9132e-02],
        [-3.0511e-04, -9.4233e-05,  7.0840e-03,  ...,  7.9479e-02,
         -1.4920e-04,  4.9428e-02]])
[Epoch 45]
==================== Evaluation ====================
F1: 0.0474 	
MAP: 0.0328 	
MRR: 0.0419 	
MNDCG: 0.0696 	
[Epoch 46] Loss: 122.2416534 Forward: 0.867s Backward: 0.521s 
[Epoch 47] Loss: 122.2824097 Forward: 1.063s Backward: 0.622s 
[Epoch 48] Loss: 122.2858887 Forward: 1.100s Backward: 0.586s 
[Epoch 49] Loss: 121.8784866 Forward: 1.004s Backward: 0.505s 
[Epoch 50] Loss: 122.6656418 Forward: 1.093s Backward: 0.617s 
embeddings: tensor([[-2.4728e-04, -2.0632e-04,  2.5934e-02,  ...,  3.8070e-02,
         -1.0154e-04,  3.3515e-02],
        [-1.8819e-04,  1.9429e-02,  5.2657e-02,  ...,  6.4265e-02,
         -1.7297e-04,  2.1220e-02],
        [-3.1426e-04,  3.8508e-04, -7.5038e-05,  ...,  3.0500e-02,
          2.0791e-02,  5.7663e-02],
        ...,
        [-6.0683e-04, -6.5221e-06,  2.4364e-02,  ...,  1.0502e-01,
         -4.9921e-04,  5.9148e-02],
        [-1.9959e-04,  8.0941e-03, -1.6051e-05,  ...,  6.4394e-02,
         -2.8031e-04,  7.0039e-02],
        [-3.1763e-04, -6.6007e-05,  1.2459e-02,  ...,  8.9192e-02,
         -1.2491e-04,  6.0617e-02]])
[Epoch 50]
==================== Evaluation ====================
F1: 0.0545 	
MAP: 0.0353 	
MRR: 0.046 	
MNDCG: 0.078 	
Training is complete!
Starting final evaluation...
==================== Final Evaluation ====================
[Final Scores] Total Epoch 50 	 Best Epoch 50
F1: 0.0545 	
MAP: 0.0353 	
MRR: 0.046 	
MNDCG: 0.078 	
